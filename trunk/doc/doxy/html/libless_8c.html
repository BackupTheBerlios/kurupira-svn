<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Kurupira: /usr/home/iamscared/projects/kurupira/src/lib/libless/libless.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>/usr/home/iamscared/projects/kurupira/src/lib/libless/libless.c File Reference</h1><code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;openssl/ec.h&gt;</code><br>
<code>#include &lt;openssl/rand.h&gt;</code><br>
<code>#include &lt;openssl/err.h&gt;</code><br>
<code>#include &lt;openssl/evp.h&gt;</code><br>
<code>#include &lt;openssl/sha.h&gt;</code><br>
<code>#include &lt;<a class="el" href="liberror_8h-source.html">liberror.h</a>&gt;</code><br>
<code>#include &quot;<a class="el" href="libless_8h-source.html">libless.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="libless__err_8h-source.html">libless_err.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="libless__quadratic_8h-source.html">libless_quadratic.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="libless__pairing_8h-source.html">libless_pairing.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="libless__types_8h-source.html">libless_types.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="libless__timing_8h-source.html">libless_timing.h</a>&quot;</code><br>

<p>
<a href="libless_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#5b748b2b1d95168a4447a233d4cfdf04">POINT_SIZE</a>&nbsp;&nbsp;&nbsp;(P_SIZE_BYTES + 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#c551305d935e16331eda0b869af8860a">SEED_SIZE_BYTES</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#c0b0023014c696f49438a57154517877">HASH_FUNCTION</a>&nbsp;&nbsp;&nbsp;EVP_sha1()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#d6074dd11ab3c97c8135c43aab03ae95">HASH_SIZE</a>&nbsp;&nbsp;&nbsp;SHA_DIGEST_LENGTH</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#78f63ef4836dd3a6c25709956d5d0108">hash_function</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, unsigned char *out, unsigned char *in, int in_len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#722881b3daf799213b2eebec561d498f">hash_to_integer</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, BIGNUM *number, unsigned char *in, int in_len, BIGNUM *p)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#6c6b0cb77fa89c4501430406f4ff0554">libless_init</a> (<a class="el" href="structerror__t.html">libless_t</a> *env)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#651226a976ebe306d69f9e2cffe98a5d">libless_clean</a> (<a class="el" href="structerror__t.html">libless_t</a> *env)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#a8480b2115e4b7c7f91c9debe66a8c93">libless_setup</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, <a class="el" href="structlibless__params__t.html">libless_params_t</a> *parameters, <a class="el" href="libless__types_8h.html#5876c6825dda25bbb7af38aa08bcd584">libless_master_t</a> *master_key)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#62866d08bb5bfd59c3dcde7418fb6c94">libless_extract</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, <a class="el" href="libless__types_8h.html#1c48a1b2312f3848e98d7bc17588e7f4">libless_partial_t</a> *key, unsigned char *<a class="el" href="lnp__tests_8c.html#ba5ba278c53392fc2c743acad9405b52">id</a>, int id_len, <a class="el" href="libless__types_8h.html#5876c6825dda25bbb7af38aa08bcd584">libless_master_t</a> master, <a class="el" href="structlibless__params__t.html">libless_params_t</a> parameters)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#a3459b51a94931a7e4f89e75382a2284">libless_set_secret</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, <a class="el" href="libless__types_8h.html#ca70d83f31b82c1a0b69b3173ca6a256">libless_secret_t</a> *secret, <a class="el" href="structlibless__params__t.html">libless_params_t</a> parameters)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#5c0fab7d26be8f3872f33b58f9a2d601">libless_set_public</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, <a class="el" href="libless__types_8h.html#b4d366d21d59dd5812beef529ab5acef">libless_public_t</a> *public_key, <a class="el" href="libless__types_8h.html#ca70d83f31b82c1a0b69b3173ca6a256">libless_secret_t</a> secret, <a class="el" href="structlibless__params__t.html">libless_params_t</a> parameters)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#66f0a1680d21e51b9d20ed07e6fe9b98">libless_set_private</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, <a class="el" href="structlibless__private__t.html">libless_private_t</a> *private_key, <a class="el" href="libless__types_8h.html#ca70d83f31b82c1a0b69b3173ca6a256">libless_secret_t</a> secret, <a class="el" href="libless__types_8h.html#1c48a1b2312f3848e98d7bc17588e7f4">libless_partial_t</a> partial, <a class="el" href="structlibless__params__t.html">libless_params_t</a> parameters)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#62769dda83b5628fa31810baaaec1098">libless_sign</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, <a class="el" href="structlibless__signature__t.html">libless_signature_t</a> *signature, unsigned char *in, int in_len, unsigned char *<a class="el" href="lnp__tests_8c.html#ba5ba278c53392fc2c743acad9405b52">id</a>, int id_len, <a class="el" href="libless__types_8h.html#b4d366d21d59dd5812beef529ab5acef">libless_public_t</a> public_key, <a class="el" href="structlibless__private__t.html">libless_private_t</a> private_key, <a class="el" href="structlibless__params__t.html">libless_params_t</a> parameters)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libless_8c.html#e0fe15fa6e4e7a9ed6a045351d95325e">libless_verify</a> (<a class="el" href="structerror__t.html">libless_t</a> *env, int *verified, <a class="el" href="structlibless__signature__t.html">libless_signature_t</a> signature, unsigned char *in, int in_len, unsigned char *<a class="el" href="lnp__tests_8c.html#ba5ba278c53392fc2c743acad9405b52">id</a>, int id_len, <a class="el" href="libless__types_8h.html#b4d366d21d59dd5812beef529ab5acef">libless_public_t</a> public_key, <a class="el" href="structlibless__params__t.html">libless_params_t</a> parameters)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of the Certificateless Public Key Cryptography module.<p>
<dl class="version" compact><dt><b>Version:</b></dt><dd>$Header$ </dd></dl>

<p>
Definition in file <a class="el" href="libless_8c-source.html">libless.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="c0b0023014c696f49438a57154517877"></a><!-- doxytag: member="libless.c::HASH_FUNCTION" ref="c0b0023014c696f49438a57154517877" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HASH_FUNCTION&nbsp;&nbsp;&nbsp;EVP_sha1()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hash function used. 
<p>
Definition at line <a class="el" href="libless_8c-source.html#l00067">67</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
Referenced by <a class="el" href="libless_8c-source.html#l00523">hash_function()</a>.
</div>
</div><p>
<a class="anchor" name="d6074dd11ab3c97c8135c43aab03ae95"></a><!-- doxytag: member="libless.c::HASH_SIZE" ref="d6074dd11ab3c97c8135c43aab03ae95" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HASH_SIZE&nbsp;&nbsp;&nbsp;SHA_DIGEST_LENGTH          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Size in bytes of the digest value returned by the hash function. 
<p>
Definition at line <a class="el" href="libless_8c-source.html#l00072">72</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
Referenced by <a class="el" href="libless_8c-source.html#l00542">hash_to_integer()</a>.
</div>
</div><p>
<a class="anchor" name="5b748b2b1d95168a4447a233d4cfdf04"></a><!-- doxytag: member="libless.c::POINT_SIZE" ref="5b748b2b1d95168a4447a233d4cfdf04" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POINT_SIZE&nbsp;&nbsp;&nbsp;(P_SIZE_BYTES + 1)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Size of a elliptic curve point in bytes (compressed form). 
<p>
Definition at line <a class="el" href="libless_8c-source.html#l00056">56</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
Referenced by <a class="el" href="libless_8c-source.html#l00339">libless_sign()</a>.
</div>
</div><p>
<a class="anchor" name="c551305d935e16331eda0b869af8860a"></a><!-- doxytag: member="libless.c::SEED_SIZE_BYTES" ref="c551305d935e16331eda0b869af8860a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEED_SIZE_BYTES&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Size in bytes of the pseudo-random generator seed. 
<p>
Definition at line <a class="el" href="libless_8c-source.html#l00061">61</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
Referenced by <a class="el" href="libless_8c-source.html#l00108">libless_init()</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="78f63ef4836dd3a6c25709956d5d0108"></a><!-- doxytag: member="libless.c::hash_function" ref="78f63ef4836dd3a6c25709956d5d0108" args="(libless_t *env, unsigned char *out, unsigned char *in, int in_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int hash_function           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>in_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hashes an arbitrary byte vector. The output buffer must have HASH_SIZE bytes.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>out</em>&nbsp;</td><td>- the resulting hash value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in</em>&nbsp;</td><td>- the data to be hashed </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in_len</em>&nbsp;</td><td>- the length of data in bytes </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00523">523</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless_8c-source.html#l00067">HASH_FUNCTION</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="lnp__routing__table_8c-source.html#l00233">find_id()</a>, <a class="el" href="libless_8c-source.html#l00542">hash_to_integer()</a>, <a class="el" href="lnp__collision__table_8c-source.html#l00074">lnp_handle_collision()</a>, and <a class="el" href="lnp__routing__table_8c-source.html#l00147">lnp_remove_id()</a>.
</div>
</div><p>
<a class="anchor" name="722881b3daf799213b2eebec561d498f"></a><!-- doxytag: member="libless.c::hash_to_integer" ref="722881b3daf799213b2eebec561d498f" args="(libless_t *env, BIGNUM *number, unsigned char *in, int in_len, BIGNUM *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int hash_to_integer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BIGNUM *&nbsp;</td>
          <td class="paramname"> <em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>in_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BIGNUM *&nbsp;</td>
          <td class="paramname"> <em>p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hashes an arbitrary byte vector to a integer modulo p. The function computes iterated hash functions of the byte vector. The hash function used is the SHA1 function, as defined in IBCS#1. A valid OpenSSL context is passed to the function to optimize memory allocation.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>number</em>&nbsp;</td><td>- the resulting integer modulo p </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in</em>&nbsp;</td><td>- the byte vector </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in_len</em>&nbsp;</td><td>- the byte vector length in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>p</em>&nbsp;</td><td>- the modulus </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00542">542</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless_8c-source.html#l00523">hash_function()</a>, <a class="el" href="libless_8c-source.html#l00072">HASH_SIZE</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__err_8h-source.html#l00042">REASON_HASH</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless_8c-source.html#l00255">libless_extract()</a>, <a class="el" href="libless_8c-source.html#l00339">libless_sign()</a>, and <a class="el" href="libless_8c-source.html#l00421">libless_verify()</a>.
</div>
</div><p>
<a class="anchor" name="651226a976ebe306d69f9e2cffe98a5d"></a><!-- doxytag: member="libless.c::libless_clean" ref="651226a976ebe306d69f9e2cffe98a5d" args="(libless_t *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libless_clean           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Finalizes the library.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00117">117</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="62866d08bb5bfd59c3dcde7418fb6c94"></a><!-- doxytag: member="libless.c::libless_extract" ref="62866d08bb5bfd59c3dcde7418fb6c94" args="(libless_t *env, libless_partial_t *key, unsigned char *id, int id_len, libless_master_t master, libless_params_t parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_extract           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#1c48a1b2312f3848e98d7bc17588e7f4">libless_partial_t</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>id_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#5876c6825dda25bbb7af38aa08bcd584">libless_master_t</a>&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a>&nbsp;</td>
          <td class="paramname"> <em>parameters</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extracts a user partial private key from its identifier.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>- the resulting partial private key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id</em>&nbsp;</td><td>- the user identifier </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id_len</em>&nbsp;</td><td>- the length of the identifier in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>master</em>&nbsp;</td><td>- the central authority master key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parameters</em>&nbsp;</td><td>- the system parameters </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00255">255</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless__types_8h-source.html#l00050">libless_params_t::factor</a>, <a class="el" href="libless__types_8h-source.html#l00046">libless_params_t::group1</a>, <a class="el" href="libless_8c-source.html#l00542">hash_to_integer()</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__err_8h-source.html#l00042">REASON_HASH</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="6c6b0cb77fa89c4501430406f4ff0554"></a><!-- doxytag: member="libless.c::libless_init" ref="6c6b0cb77fa89c4501430406f4ff0554" args="(libless_t *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libless_init           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initializes the library.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00108">108</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00048">error_t::code</a>, <a class="el" href="liberror_8h-source.html#l00042">ERROR_LENGTH</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="liberror_8h-source.html#l00049">error_t::reason</a>, and <a class="el" href="libless_8c-source.html#l00061">SEED_SIZE_BYTES</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="66f0a1680d21e51b9d20ed07e6fe9b98"></a><!-- doxytag: member="libless.c::libless_set_private" ref="66f0a1680d21e51b9d20ed07e6fe9b98" args="(libless_t *env, libless_private_t *private_key, libless_secret_t secret, libless_partial_t partial, libless_params_t parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_set_private           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__private__t.html">libless_private_t</a> *&nbsp;</td>
          <td class="paramname"> <em>private</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#ca70d83f31b82c1a0b69b3173ca6a256">libless_secret_t</a>&nbsp;</td>
          <td class="paramname"> <em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#1c48a1b2312f3848e98d7bc17588e7f4">libless_partial_t</a>&nbsp;</td>
          <td class="paramname"> <em>partial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a>&nbsp;</td>
          <td class="paramname"> <em>parameters</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructs a private key from the partial private key and the user secret.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>private</em>&nbsp;</td><td>- the resulting private key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>secret</em>&nbsp;</td><td>- the user secret </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>partial</em>&nbsp;</td><td>- the user partial private key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parameters</em>&nbsp;</td><td>- the system parameters. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00319">319</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless__types_8h-source.html#l00047">libless_params_t::group2</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__types_8h-source.html#l00078">libless_private_t::partial</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, <a class="el" href="libless__types_8h-source.html#l00077">libless_private_t::secret</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="5c0fab7d26be8f3872f33b58f9a2d601"></a><!-- doxytag: member="libless.c::libless_set_public" ref="5c0fab7d26be8f3872f33b58f9a2d601" args="(libless_t *env, libless_public_t *public_key, libless_secret_t secret, libless_params_t parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_set_public           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#b4d366d21d59dd5812beef529ab5acef">libless_public_t</a> *&nbsp;</td>
          <td class="paramname"> <em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#ca70d83f31b82c1a0b69b3173ca6a256">libless_secret_t</a>&nbsp;</td>
          <td class="paramname"> <em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a>&nbsp;</td>
          <td class="paramname"> <em>parameters</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generates a user public key from the user secret.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>public_key</em>&nbsp;</td><td>- the resulting public key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>secret</em>&nbsp;</td><td>- the user secret </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parameters</em>&nbsp;</td><td>- the system parameters </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00299">299</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__pairing_8c-source.html#l00167">libless_pairing_power()</a>, <a class="el" href="libless__types_8h-source.html#l00048">libless_params_t::pairing</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00044">REASON_PAIRING</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="a3459b51a94931a7e4f89e75382a2284"></a><!-- doxytag: member="libless.c::libless_set_secret" ref="a3459b51a94931a7e4f89e75382a2284" args="(libless_t *env, libless_secret_t *secret, libless_params_t parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_set_secret           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#ca70d83f31b82c1a0b69b3173ca6a256">libless_secret_t</a> *&nbsp;</td>
          <td class="paramname"> <em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a>&nbsp;</td>
          <td class="paramname"> <em>parameters</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generates a user secret.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>secret</em>&nbsp;</td><td>- the resulting secret </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parameters</em>&nbsp;</td><td>- the system parameters </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00286">286</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless__types_8h-source.html#l00050">libless_params_t::factor</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="a8480b2115e4b7c7f91c9debe66a8c93"></a><!-- doxytag: member="libless.c::libless_setup" ref="a8480b2115e4b7c7f91c9debe66a8c93" args="(libless_t *env, libless_params_t *parameters, libless_master_t *master_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_setup           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#5876c6825dda25bbb7af38aa08bcd584">libless_master_t</a> *&nbsp;</td>
          <td class="paramname"> <em>master_key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generates a set of system parameters and a master key to be used by the centralized authority.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>- the resulting system parameters </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>master_key</em>&nbsp;</td><td>- the resulting master key </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00123">123</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="libless_8h-source.html#l00067">CURVE_A</a>, <a class="el" href="libless_8h-source.html#l00070">CURVE_B</a>, <a class="el" href="libless_8h-source.html#l00073">CURVE_H</a>, <a class="el" href="libless_8h-source.html#l00064">CURVE_P</a>, <a class="el" href="libless_8h-source.html#l00076">CURVE_R</a>, <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless__types_8h-source.html#l00050">libless_params_t::factor</a>, <a class="el" href="libless__types_8h-source.html#l00044">libless_params_t::generator1</a>, <a class="el" href="libless__types_8h-source.html#l00045">libless_params_t::generator2</a>, <a class="el" href="libless__types_8h-source.html#l00046">libless_params_t::group1</a>, <a class="el" href="libless__types_8h-source.html#l00047">libless_params_t::group2</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__pairing_8c-source.html#l00143">libless_pairing()</a>, <a class="el" href="libless_8h-source.html#l00105">P_SIZE_BITS</a>, <a class="el" href="libless__types_8h-source.html#l00048">libless_params_t::pairing</a>, <a class="el" href="libless__types_8h-source.html#l00049">libless_params_t::prime</a>, <a class="el" href="libless__types_8h-source.html#l00043">libless_params_t::public</a>, <a class="el" href="libless__err_8h-source.html#l00040">REASON_CURVE_PARAMETERS</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, <a class="el" href="libless__err_8h-source.html#l00044">REASON_PAIRING</a>, <a class="el" href="liberror_8h-source.html#l00154">TRY</a>, <a class="el" href="libless_8h-source.html#l00094">TWISTED_B</a>, and <a class="el" href="libless_8h-source.html#l00098">TWISTED_H</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="62769dda83b5628fa31810baaaec1098"></a><!-- doxytag: member="libless.c::libless_sign" ref="62769dda83b5628fa31810baaaec1098" args="(libless_t *env, libless_signature_t *signature, unsigned char *in, int in_len, unsigned char *id, int id_len, libless_public_t public_key, libless_private_t private_key, libless_params_t parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_sign           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__signature__t.html">libless_signature_t</a> *&nbsp;</td>
          <td class="paramname"> <em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>in_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>id_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#b4d366d21d59dd5812beef529ab5acef">libless_public_t</a>&nbsp;</td>
          <td class="paramname"> <em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__private__t.html">libless_private_t</a>&nbsp;</td>
          <td class="paramname"> <em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a>&nbsp;</td>
          <td class="paramname"> <em>parameters</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Signs data with the user identifier and key pair.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>signature</em>&nbsp;</td><td>- the resulting signature </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in</em>&nbsp;</td><td>- the data to sign </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in_len</em>&nbsp;</td><td>- the number of bytes to sign </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id</em>&nbsp;</td><td>- the user identifier </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id_len</em>&nbsp;</td><td>- the length of the identifier in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>public_key</em>&nbsp;</td><td>- the user public key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>private_key</em>&nbsp;</td><td>- the signing private key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parameters</em>&nbsp;</td><td>- the system parameters </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00339">339</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="libless__types_8h-source.html#l00050">libless_params_t::factor</a>, <a class="el" href="libless__types_8h-source.html#l00046">libless_params_t::group1</a>, <a class="el" href="libless__types_8h-source.html#l00087">libless_signature_t::hash</a>, <a class="el" href="libless__types_8h-source.html#l00088">libless_signature_t::hash_len</a>, <a class="el" href="libless_8c-source.html#l00542">hash_to_integer()</a>, <a class="el" href="libless__types_8h-source.html#l00085">libless_signature_t::image</a>, <a class="el" href="libless__types_8h-source.html#l00086">libless_signature_t::image_len</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__pairing_8c-source.html#l00167">libless_pairing_power()</a>, <a class="el" href="libless_8h-source.html#l00110">P_SIZE_BYTES</a>, <a class="el" href="libless__types_8h-source.html#l00048">libless_params_t::pairing</a>, <a class="el" href="libless__types_8h-source.html#l00078">libless_private_t::partial</a>, <a class="el" href="libless_8c-source.html#l00056">POINT_SIZE</a>, <a class="el" href="libless_8h-source.html#l00120">R_SIZE_BYTES</a>, <a class="el" href="libless__err_8h-source.html#l00042">REASON_HASH</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, <a class="el" href="libless__types_8h-source.html#l00077">libless_private_t::secret</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="e0fe15fa6e4e7a9ed6a045351d95325e"></a><!-- doxytag: member="libless.c::libless_verify" ref="e0fe15fa6e4e7a9ed6a045351d95325e" args="(libless_t *env, int *verified, libless_signature_t signature, unsigned char *in, int in_len, unsigned char *id, int id_len, libless_public_t public_key, libless_params_t parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libless_verify           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structerror__t.html">libless_t</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>verified</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__signature__t.html">libless_signature_t</a>&nbsp;</td>
          <td class="paramname"> <em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>in_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>id_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libless__types_8h.html#b4d366d21d59dd5812beef529ab5acef">libless_public_t</a>&nbsp;</td>
          <td class="paramname"> <em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibless__params__t.html">libless_params_t</a>&nbsp;</td>
          <td class="paramname"> <em>parameters</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Deciphers a cryptogram with the user private key.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>- the library context </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>verified</em>&nbsp;</td><td>- a boolean indicating if the signature is valid </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>signature</em>&nbsp;</td><td>- the signature to verify </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in</em>&nbsp;</td><td>- the data signed </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in_len</em>&nbsp;</td><td>- the number of bytes signed </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id</em>&nbsp;</td><td>- the user identifier </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id_len</em>&nbsp;</td><td>- the length of the identifier in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>public_key</em>&nbsp;</td><td>- the user public key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parameters</em>&nbsp;</td><td>- the system parameters </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>LIBLESS_OK if no error occurs, LIBLESS_ERROR otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="libless_8c-source.html#l00421">421</a> of file <a class="el" href="libless_8c-source.html">libless.c</a>.
<p>
References <a class="el" href="liberror_8h-source.html#l00060">ERR</a>, <a class="el" href="liberror_8h-source.html#l00072">ERROR</a>, <a class="el" href="libless__types_8h-source.html#l00050">libless_params_t::factor</a>, <a class="el" href="libless__types_8h-source.html#l00046">libless_params_t::group1</a>, <a class="el" href="libless__types_8h-source.html#l00047">libless_params_t::group2</a>, <a class="el" href="lnp__id_8c-source.html#l00049">hash</a>, <a class="el" href="libless__types_8h-source.html#l00087">libless_signature_t::hash</a>, <a class="el" href="libless__types_8h-source.html#l00088">libless_signature_t::hash_len</a>, <a class="el" href="libless_8c-source.html#l00542">hash_to_integer()</a>, <a class="el" href="libless__types_8h-source.html#l00085">libless_signature_t::image</a>, <a class="el" href="libless__types_8h-source.html#l00086">libless_signature_t::image_len</a>, <a class="el" href="libless_8h-source.html#l00051">LIBLESS_ERROR</a>, <a class="el" href="libless_8h-source.html#l00046">LIBLESS_OK</a>, <a class="el" href="libless__pairing_8c-source.html#l00143">libless_pairing()</a>, <a class="el" href="libless__pairing_8c-source.html#l00210">libless_pairing_multiply()</a>, <a class="el" href="libless__pairing_8c-source.html#l00167">libless_pairing_power()</a>, <a class="el" href="libless_8h-source.html#l00110">P_SIZE_BYTES</a>, <a class="el" href="libless__types_8h-source.html#l00043">libless_params_t::public</a>, <a class="el" href="libless__err_8h-source.html#l00042">REASON_HASH</a>, <a class="el" href="kurud__err_8h-source.html#l00041">REASON_MEMORY</a>, <a class="el" href="libless__err_8h-source.html#l00052">REASON_OPENSSL</a>, <a class="el" href="libless__err_8h-source.html#l00044">REASON_PAIRING</a>, and <a class="el" href="liberror_8h-source.html#l00154">TRY</a>.
<p>
Referenced by <a class="el" href="libless__test_8c-source.html#l00044">main()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue Mar 20 00:15:38 2007 for Kurupira by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
