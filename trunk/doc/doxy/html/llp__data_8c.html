<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Kurupira: /usr/home/iamscared/projects/kurupira/src/llp/llp_data.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>/usr/home/iamscared/projects/kurupira/src/llp/llp_data.c File Reference</h1><code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &lt;sys/socket.h&gt;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>
<code>#include &lt;libfreedom/liblog.h&gt;</code><br>
<code>#include &lt;util/util_crypto.h&gt;</code><br>
<code>#include &lt;util/util_data.h&gt;</code><br>
<code>#include &lt;util/util.h&gt;</code><br>
<code>#include &quot;<a class="el" href="llp_8h-source.html">llp.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="llp__data_8h-source.html">llp_data.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="llp__nodes_8h-source.html">llp_nodes.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="llp__packets_8h-source.html">llp_packets.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="llp__sessions_8h-source.html">llp_sessions.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="llp__info_8h-source.html">llp_info.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="llp__queue_8h-source.html">llp_queue.h</a>&quot;</code><br>

<p>
<a href="llp__data_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#82acb32225c05e9aa4c524c40bc5852a">MAX_CHAR</a>&nbsp;&nbsp;&nbsp;255</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#734aad72b40583625431a1dbf01f8e61">send_data</a> (int session, u_char *data, int length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#867e322dbef981e8cf9058a27a0a4e16">send_datagram</a> (int session, u_char *datagram, int length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#6f013dbc405cfdcc8301cfcc3cf92e51">send_close</a> (int session, u_char type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#b55512154894d7957a716f399aaf3b54">send_close_ok</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#6304b5ebc11daffa5771e83fc0554395">send_close_request</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#7a6ba2d77d5dc26d6d0312b9f0af04b2">send_node_hunt</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#baade8dbceb30b3d42515ce71932b2fb">send_hunt_result</a> (int session, struct sockaddr_in *addresses, int number)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#2ccd0ffed0c54f783b3b2617455ed462">send_keep_alive</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#80a6374a9bdc71d7529ebef9b3306fa8">handle_encrypted_content</a> (u_char *content, int length, u_char *mac, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#c958124d03f354b1841ee1af00ab6ae2">handle_content</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#e251757de4d1601654492194f78470eb">handle_datagram</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#1da2bcdb6cd9d8908f458bae26603188">handle_closing</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#c9194ede8b047567602c53b7a713efe0">handle_close_request</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#109913baf6bbb61e966a51158b5a62e9">handle_close_ok</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#6ed076109b513028e623ac887e40bb65">handle_node_hunt</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#e843309063ad270eefe3ae389de9f2a3">handle_hunt_result</a> (u_char *content, int length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#bd587b4ba8bd20b22caba5cdf332abfe">handle_keep_alive</a> (u_char *content, int content_length, int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#13e5063bd901d558c5c3739ffd4e465a">parse_hunt_result</a> (<a class="el" href="structllp__data__p.html">llp_data_p</a> *packet, u_char *data, int length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#a74db525c1dbc3828018663958cd2af1">llp_handle_data</a> (u_char *packet_data, int packet_length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#f57dbe64bf61b9007a3b25be593f3f83">llp_keep_session_alive</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#0f1b89db367e5f228c2ca44d1cf3d948">llp_hunt_for_nodes</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#62da330f804e3b155b1ebafb2e18b188">llp_disconnect</a> (int session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#c2339f058886a37e05ffaf97b47f2b39">llp_read</a> (int *session, u_char *data, int max)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#0a27e4cf5a4414b43fb912f1ff45307b">llp_flush</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#9c0b60d9da4872cb667ccceac1d08067">llp_write</a> (int session, u_char *data, int length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="llp__data_8c.html#4597b43b85c30e306fbf53fd25386116">llp_hunt_valid</a> (int session)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of functions used to manipulate LLP_DATA packets. 
<p>
Definition in file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="82acb32225c05e9aa4c524c40bc5852a"></a><!-- doxytag: member="llp_data.c::MAX_CHAR" ref="82acb32225c05e9aa4c524c40bc5852a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CHAR&nbsp;&nbsp;&nbsp;255          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Max value of an unsigned char. 
<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00061">61</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00861">handle_node_hunt()</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="109913baf6bbb61e966a51158b5a62e9"></a><!-- doxytag: member="llp_data.c::handle_close_ok" ref="109913baf6bbb61e966a51158b5a62e9" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_close_ok           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the LLP_CLOSE_OK packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_CLOSE_OK packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00850">850</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__data_8c-source.html#l00802">handle_closing()</a>, <a class="el" href="llp__sessions_8c-source.html#l00350">llp_close_session()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, and <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>.
</div>
</div><p>
<a class="anchor" name="c9194ede8b047567602c53b7a713efe0"></a><!-- doxytag: member="llp_data.c::handle_close_request" ref="c9194ede8b047567602c53b7a713efe0" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_close_request           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the LLP_CLOSE_REQUEST packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_CLOSE_REQUEST packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00833">833</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__data_8c-source.html#l00802">handle_closing()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__nodes_8c-source.html#l00357">llp_set_node_inactive()</a>, <a class="el" href="llp__sessions_8h-source.html#l00054">LLP_STATE_TIME_WAIT</a>, <a class="el" href="llp__sessions_8h-source.html#l00083">LLP_T_TIMEOUT</a>, <a class="el" href="llp__data_8c-source.html#l00642">send_close_ok()</a>, <a class="el" href="llp__sessions_8h-source.html#l00094">llp_session_t::state</a>, and <a class="el" href="llp__sessions_8h-source.html#l00104">llp_session_t::timeout</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>.
</div>
</div><p>
<a class="anchor" name="1da2bcdb6cd9d8908f458bae26603188"></a><!-- doxytag: member="llp_data.c::handle_closing" ref="1da2bcdb6cd9d8908f458bae26603188" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_closing           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the process of verify the authenticity of a LLP_CLOSE_REQUEST packet or LLP_CLOSE_OK packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_CLOSE_* packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00802">802</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__packets_8h-source.html#l00242">llp_data_p::content_type</a>, <a class="el" href="llp__sessions_8h-source.html#l00118">llp_session_t::hash</a>, <a class="el" href="lnp__id_8c-source.html#l00049">hash</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, and <a class="el" href="llp__sessions_8h-source.html#l00146">llp_session_t::verifier</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00850">handle_close_ok()</a>, and <a class="el" href="llp__data_8c-source.html#l00833">handle_close_request()</a>.
</div>
</div><p>
<a class="anchor" name="c958124d03f354b1841ee1af00ab6ae2"></a><!-- doxytag: member="llp_data.c::handle_content" ref="c958124d03f354b1841ee1af00ab6ae2" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_content           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content (not encrypted) of the LLP_DATA packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00763">763</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__packets_8h-source.html#l00242">llp_data_p::content_type</a>, <a class="el" href="llp__data_8c-source.html#l00850">handle_close_ok()</a>, <a class="el" href="llp__data_8c-source.html#l00833">handle_close_request()</a>, <a class="el" href="llp__data_8c-source.html#l00798">handle_datagram()</a>, <a class="el" href="llp__data_8c-source.html#l00899">handle_hunt_result()</a>, <a class="el" href="llp__data_8c-source.html#l00928">handle_keep_alive()</a>, <a class="el" href="llp__data_8c-source.html#l00861">handle_node_hunt()</a>, <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc5078d37466e2fc7915cede86f897fcc034">LLP_CLOSE_OK</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc507704b549cbf8783e3a6f1937edf9ff9c">LLP_CLOSE_REQUEST</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc50520cef8aaba56601c93620fa62f9dbff">LLP_DATAGRAM</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc505d1b24303215f089d62eee0d674fa9e7">LLP_HUNT_RESULT</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc5088238ad8f68da32781a5e446079aabb9">LLP_KEEP_ALIVE</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc50434da71d53a4041e0d9c648b82a46abb">LLP_NODE_HUNT</a>, and <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00715">handle_encrypted_content()</a>.
</div>
</div><p>
<a class="anchor" name="e251757de4d1601654492194f78470eb"></a><!-- doxytag: member="llp_data.c::handle_datagram" ref="e251757de4d1601654492194f78470eb" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_datagram           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the LLP_DATAGRAM packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_DATAGRAM packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00798">798</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__queue_8c-source.html#l00063">llp_enqueue_datagram()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>.
</div>
</div><p>
<a class="anchor" name="80a6374a9bdc71d7529ebef9b3306fa8"></a><!-- doxytag: member="llp_data.c::handle_encrypted_content" ref="80a6374a9bdc71d7529ebef9b3306fa8" args="(u_char *content, int length, u_char *mac, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_encrypted_content           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the encrypted portion of the packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the encrypted portion of the LLP_DATA packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the length of the encrypted content, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mac</em>&nbsp;</td><td>- the LLP_DATA plaintext's MAC value. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00715">715</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__sessions_8h-source.html#l00116">llp_session_t::cipher</a>, <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>, <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h-source.html#l00120">llp_session_t::mac</a>, and <a class="el" href="llp__packets_8h-source.html#l00238">llp_data_p::padding_length</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00264">llp_handle_data()</a>.
</div>
</div><p>
<a class="anchor" name="e843309063ad270eefe3ae389de9f2a3"></a><!-- doxytag: member="llp_data.c::handle_hunt_result" ref="e843309063ad270eefe3ae389de9f2a3" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_hunt_result           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the LLP_HUNT_RESULT packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_HUNT_RESULT packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00899">899</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp__nodes_8c-source.html#l00255">llp_add_node_to_cache()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__data_8c-source.html#l00441">llp_hunt_valid()</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, and <a class="el" href="llp__data_8c-source.html#l00933">parse_hunt_result()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>.
</div>
</div><p>
<a class="anchor" name="bd587b4ba8bd20b22caba5cdf332abfe"></a><!-- doxytag: member="llp_data.c::handle_keep_alive" ref="bd587b4ba8bd20b22caba5cdf332abfe" args="(u_char *content, int content_length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_keep_alive           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>content_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the LLP_KEEP_ALIVE packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_KEEP_ALIVE packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00928">928</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h-source.html#l00083">LLP_T_TIMEOUT</a>, and <a class="el" href="llp__sessions_8h-source.html#l00104">llp_session_t::timeout</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>.
</div>
</div><p>
<a class="anchor" name="6ed076109b513028e623ac887e40bb65"></a><!-- doxytag: member="llp_data.c::handle_node_hunt" ref="6ed076109b513028e623ac887e40bb65" args="(u_char *content, int length, int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_node_hunt           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles the LLP_NODE_HUNT packet carried inside the LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>content</em>&nbsp;</td><td>- the content of the LLP_NODE_HUNT packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the content length of the packet, in bytes. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session that the packet was received. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00861">861</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp__packets_8h-source.html#l00112">LLP_ADDRESS_INET_LENGTH</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__nodes_8c-source.html#l00220">llp_get_nodes_from_cache()</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__data_8c-source.html#l00061">MAX_CHAR</a>, and <a class="el" href="llp__data_8c-source.html#l00669">send_hunt_result()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00763">handle_content()</a>.
</div>
</div><p>
<a class="anchor" name="62da330f804e3b155b1ebafb2e18b188"></a><!-- doxytag: member="llp_data.c::llp_disconnect" ref="62da330f804e3b155b1ebafb2e18b188" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_disconnect           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disconnects the given session.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- session identifier. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00386">386</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp__info_8c-source.html#l00094">llp_add_active_sessions_counter()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8h-source.html#l00178">llp_lock_session</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80de41a33cc29d2d9ec0909f305c3e82ec70">LLP_STATE_CLOSE_WAIT</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80deec73b365db22b1ca5d7ee54bfcf23a5b">LLP_STATE_ESTABLISHED</a>, <a class="el" href="llp__sessions_8h-source.html#l00186">llp_unlock_session</a>, <a class="el" href="llp__data_8c-source.html#l00646">send_close_request()</a>, and <a class="el" href="llp__sessions_8h-source.html#l00094">llp_session_t::state</a>.
<p>
Referenced by <a class="el" href="llp__console_8c-source.html#l00513">console_disconnect()</a>, <a class="el" href="llp__core_8c-source.html#l00064">link_get_interface()</a>, <a class="el" href="llp__sessions_8c-source.html#l00471">llp_handle_silence()</a>, and <a class="el" href="llp__sessions_8c-source.html#l00442">llp_handle_timeouts()</a>.
</div>
</div><p>
<a class="anchor" name="0a27e4cf5a4414b43fb912f1ff45307b"></a><!-- doxytag: member="llp_data.c::llp_flush" ref="0a27e4cf5a4414b43fb912f1ff45307b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_flush           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Removes all enqueued messages.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of messages flushed. </dd></dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00416">416</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, and <a class="el" href="llp__queue_8c-source.html#l00079">llp_try_dequeue_datagram()</a>.
<p>
Referenced by <a class="el" href="llp__console_8c-source.html#l00596">console_flush()</a>.
</div>
</div><p>
<a class="anchor" name="a74db525c1dbc3828018663958cd2af1"></a><!-- doxytag: member="llp_data.c::llp_handle_data" ref="a74db525c1dbc3828018663958cd2af1" args="(u_char *packet_data, int packet_length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_handle_data           </td>
          <td>(</td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>packet_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>packet_length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle a received LLP_DATA packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>packet_data</em>&nbsp;</td><td>- packet data. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>packet_length</em>&nbsp;</td><td>- packet length in bytes. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00264">264</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__data_8c-source.html#l00715">handle_encrypted_content()</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8h-source.html#l00178">llp_lock_session</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80de523d9fd1087805042a5d01a14728c119">LLP_STATE_BEING_CONNECTED</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80de41a33cc29d2d9ec0909f305c3e82ec70">LLP_STATE_CLOSE_WAIT</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80de8e03cd1d09016a938083b736763cd7bd">LLP_STATE_CLOSED</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80dea0cdbf5afeeb1b7e43c82489be9f4fe7">LLP_STATE_CONNECTING</a>, <a class="el" href="llp__sessions_8h-source.html#l00083">LLP_T_TIMEOUT</a>, <a class="el" href="llp__sessions_8h-source.html#l00186">llp_unlock_session</a>, <a class="el" href="llp__sessions_8h-source.html#l00120">llp_session_t::mac</a>, <a class="el" href="llp__sessions_8h-source.html#l00100">llp_session_t::packets_received</a>, <a class="el" href="llp__sessions_8h-source.html#l00104">llp_session_t::timeout</a>, and <a class="el" href="llp__packets_8h-source.html#l00285">llp_packet_p::type</a>.
<p>
Referenced by <a class="el" href="llp__socket_8c-source.html#l00097">llp_listen_socket()</a>.
</div>
</div><p>
<a class="anchor" name="0f1b89db367e5f228c2ca44d1cf3d948"></a><!-- doxytag: member="llp_data.c::llp_hunt_for_nodes" ref="0f1b89db367e5f228c2ca44d1cf3d948" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_hunt_for_nodes           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Requests new nodes to the given session.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- session identifier. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00366">366</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__sessions_8h-source.html#l00108">llp_session_t::hunt_time</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8h-source.html#l00178">llp_lock_session</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80deec73b365db22b1ca5d7ee54bfcf23a5b">LLP_STATE_ESTABLISHED</a>, <a class="el" href="llp__sessions_8h-source.html#l00186">llp_unlock_session</a>, and <a class="el" href="llp__data_8c-source.html#l00650">send_node_hunt()</a>.
<p>
Referenced by <a class="el" href="llp__nodes_8c-source.html#l00411">llp_handle_nodes()</a>.
</div>
</div><p>
<a class="anchor" name="4597b43b85c30e306fbf53fd25386116"></a><!-- doxytag: member="llp_data.c::llp_hunt_valid" ref="4597b43b85c30e306fbf53fd25386116" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_hunt_valid           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the last hunt node sent is still valid.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if the node hunt has not expired </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00441">441</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__sessions_8h-source.html#l00108">llp_session_t::hunt_time</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8h-source.html#l00178">llp_lock_session</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h-source.html#l00083">LLP_T_TIMEOUT</a>, <a class="el" href="llp__sessions_8h-source.html#l00079">LLP_TIME_TICKS_PER_SECOND</a>, and <a class="el" href="llp__sessions_8h-source.html#l00186">llp_unlock_session</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00899">handle_hunt_result()</a>, and <a class="el" href="llp__nodes_8c-source.html#l00411">llp_handle_nodes()</a>.
</div>
</div><p>
<a class="anchor" name="f57dbe64bf61b9007a3b25be593f3f83"></a><!-- doxytag: member="llp_data.c::llp_keep_session_alive" ref="f57dbe64bf61b9007a3b25be593f3f83" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_keep_session_alive           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Keeps the given session alive, sending the an LLP_KEEP_ALIVE packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- session identifier. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00351">351</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8h-source.html#l00178">llp_lock_session</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80deec73b365db22b1ca5d7ee54bfcf23a5b">LLP_STATE_ESTABLISHED</a>, <a class="el" href="llp__sessions_8h-source.html#l00186">llp_unlock_session</a>, and <a class="el" href="llp__data_8c-source.html#l00697">send_keep_alive()</a>.
<p>
Referenced by <a class="el" href="llp__sessions_8c-source.html#l00471">llp_handle_silence()</a>.
</div>
</div><p>
<a class="anchor" name="c2339f058886a37e05ffaf97b47f2b39"></a><!-- doxytag: member="llp_data.c::llp_read" ref="c2339f058886a37e05ffaf97b47f2b39" args="(int *session, u_char *data, int max)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_read           </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reads data received by the LLP module.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- session that received this datagram. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>- array that will receive data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>max</em>&nbsp;</td><td>- max number of bytes that can be read (i.e., the size of data). </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>number in bytes of read, LLP_ERROR if errors occurred. </dd></dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00411">411</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__queue_8c-source.html#l00071">llp_dequeue_datagram()</a>, and <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>.
<p>
Referenced by <a class="el" href="llp__console_8c-source.html#l00581">console_read_data()</a>, and <a class="el" href="llp__core_8c-source.html#l00064">link_get_interface()</a>.
</div>
</div><p>
<a class="anchor" name="9c0b60d9da4872cb667ccceac1d08067"></a><!-- doxytag: member="llp_data.c::llp_write" ref="9c0b60d9da4872cb667ccceac1d08067" args="(int session, u_char *data, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int llp_write           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends generic data by the given session.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- session identifier. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>- data to be sent. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data in bytes. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00426">426</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__sessions_8h-source.html#l00178">llp_lock_session</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h.html#c6c611a4a85f7b2d3b3fc213b97e80deec73b365db22b1ca5d7ee54bfcf23a5b">LLP_STATE_ESTABLISHED</a>, <a class="el" href="llp__sessions_8h-source.html#l00186">llp_unlock_session</a>, and <a class="el" href="llp__data_8c-source.html#l00582">send_datagram()</a>.
<p>
Referenced by <a class="el" href="llp__console_8c-source.html#l00556">console_write_data()</a>, and <a class="el" href="llp__core_8c-source.html#l00064">link_get_interface()</a>.
</div>
</div><p>
<a class="anchor" name="13e5063bd901d558c5c3739ffd4e465a"></a><!-- doxytag: member="llp_data.c::parse_hunt_result" ref="13e5063bd901d558c5c3739ffd4e465a" args="(llp_data_p *packet, u_char *data, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_hunt_result           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structllp__data__p.html">llp_data_p</a> *&nbsp;</td>
          <td class="paramname"> <em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reads the contents of a LLP_HUNT_RESULT into packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>packet</em>&nbsp;</td><td>- packet representing the parsed data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>- data to parse. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- length of the packet buffer, in bytes. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00933">933</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__packets_8h-source.html#l00242">llp_data_p::content_type</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, and <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00899">handle_hunt_result()</a>.
</div>
</div><p>
<a class="anchor" name="6f013dbc405cfdcc8301cfcc3cf92e51"></a><!-- doxytag: member="llp_data.c::send_close" ref="6f013dbc405cfdcc8301cfcc3cf92e51" args="(int session, u_char type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_close           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends a packet with a LLP_CLOSE_* pattern.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session used to send the packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>- the type of LLP_CLOSE_* packet. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00611">611</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__sessions_8h-source.html#l00118">llp_session_t::hash</a>, <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, and <a class="el" href="llp__data_8c-source.html#l00464">send_data()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00642">send_close_ok()</a>, and <a class="el" href="llp__data_8c-source.html#l00646">send_close_request()</a>.
</div>
</div><p>
<a class="anchor" name="b55512154894d7957a716f399aaf3b54"></a><!-- doxytag: member="llp_data.c::send_close_ok" ref="b55512154894d7957a716f399aaf3b54" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_close_ok           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends an LLP_CLOSE_OK packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session used to send the packet. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00642">642</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc5078d37466e2fc7915cede86f897fcc034">LLP_CLOSE_OK</a>, and <a class="el" href="llp__data_8c-source.html#l00611">send_close()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00833">handle_close_request()</a>.
</div>
</div><p>
<a class="anchor" name="6304b5ebc11daffa5771e83fc0554395"></a><!-- doxytag: member="llp_data.c::send_close_request" ref="6304b5ebc11daffa5771e83fc0554395" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_close_request           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00646">646</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc507704b549cbf8783e3a6f1937edf9ff9c">LLP_CLOSE_REQUEST</a>, and <a class="el" href="llp__data_8c-source.html#l00611">send_close()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00386">llp_disconnect()</a>.
</div>
</div><p>
<a class="anchor" name="734aad72b40583625431a1dbf01f8e61"></a><!-- doxytag: member="llp_data.c::send_data" ref="734aad72b40583625431a1dbf01f8e61" args="(int session, u_char *data, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_data           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends an LLP_DATA packet, given its contents.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session used to send the packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>- the data to encapsulate in a LLP_DATA packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the length of data in bytes. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00464">464</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="llp__sessions_8h-source.html#l00116">llp_session_t::cipher</a>, <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc504eaec50f73d017c4a1050de5b306bb7d">LLP_DATA</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__packets_8h-source.html#l00065">LLP_MIN_PADDING_LENGTH</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, <a class="el" href="llp__packets_8c-source.html#l00057">llp_send_session_packet()</a>, <a class="el" href="llp__sessions_8h-source.html#l00070">LLP_SESSION_NOT_ENCRYPTED</a>, <a class="el" href="llp__sessions_8c-source.html#l00069">llp_sessions</a>, <a class="el" href="llp__sessions_8h-source.html#l00120">llp_session_t::mac</a>, <a class="el" href="llp__sessions_8h-source.html#l00098">llp_session_t::packets_sent</a>, and <a class="el" href="llp__sessions_8h-source.html#l00106">llp_session_t::silence</a>.
<p>
Referenced by <a class="el" href="lnp__data_8c-source.html#l00182">lnp_write()</a>, <a class="el" href="llp__data_8c-source.html#l00611">send_close()</a>, <a class="el" href="llp__data_8c-source.html#l00582">send_datagram()</a>, <a class="el" href="llp__data_8c-source.html#l00669">send_hunt_result()</a>, <a class="el" href="llp__data_8c-source.html#l00697">send_keep_alive()</a>, and <a class="el" href="llp__data_8c-source.html#l00650">send_node_hunt()</a>.
</div>
</div><p>
<a class="anchor" name="867e322dbef981e8cf9058a27a0a4e16"></a><!-- doxytag: member="llp_data.c::send_datagram" ref="867e322dbef981e8cf9058a27a0a4e16" args="(int session, u_char *datagram, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_datagram           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char *&nbsp;</td>
          <td class="paramname"> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends an LLP_DATAGRAM packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session used to send the packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>- the data to encapsulate in a LLP_DATAGRAM packet. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>- the length of data in bytes. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00582">582</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="liblog_8c-source.html#l00113">liblog_fatal()</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc50520cef8aaba56601c93620fa62f9dbff">LLP_DATAGRAM</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, and <a class="el" href="llp__data_8c-source.html#l00464">send_data()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00426">llp_write()</a>.
</div>
</div><p>
<a class="anchor" name="baade8dbceb30b3d42515ce71932b2fb"></a><!-- doxytag: member="llp_data.c::send_hunt_result" ref="baade8dbceb30b3d42515ce71932b2fb" args="(int session, struct sockaddr_in *addresses, int number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_hunt_result           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>addresses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>number</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00669">669</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp__packets_8h-source.html#l00087">LLP_ADDRESS_INET</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc505d1b24303215f089d62eee0d674fa9e7">LLP_HUNT_RESULT</a>, <a class="el" href="llp__packets_8h-source.html#l00117">LLP_HUNT_RESULT_MAX_LENGTH</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, and <a class="el" href="llp__data_8c-source.html#l00464">send_data()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00861">handle_node_hunt()</a>.
</div>
</div><p>
<a class="anchor" name="2ccd0ffed0c54f783b3b2617455ed462"></a><!-- doxytag: member="llp_data.c::send_keep_alive" ref="2ccd0ffed0c54f783b3b2617455ed462" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_keep_alive           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends an LLP_KEEP_ALIVE packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>session[in]</em>&nbsp;</td><td>- the session used to send the packet. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00697">697</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc5088238ad8f68da32781a5e446079aabb9">LLP_KEEP_ALIVE</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, and <a class="el" href="llp__data_8c-source.html#l00464">send_data()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00351">llp_keep_session_alive()</a>.
</div>
</div><p>
<a class="anchor" name="7a6ba2d77d5dc26d6d0312b9f0af04b2"></a><!-- doxytag: member="llp_data.c::send_node_hunt" ref="7a6ba2d77d5dc26d6d0312b9f0af04b2" args="(int session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_node_hunt           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends an LLP_NODE_HUNT packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>- the session used to send the packet. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>LLP_OK</em>&nbsp;</td><td>- if no errors occurred </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LLP_ERROR</em>&nbsp;</td><td>- otherwise </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="llp__data_8c-source.html#l00650">650</a> of file <a class="el" href="llp__data_8c-source.html">llp_data.c</a>.
<p>
References <a class="el" href="liblog_8h-source.html#l00057">liblog_debug</a>, <a class="el" href="liblog_8c-source.html#l00102">liblog_error()</a>, <a class="el" href="llp_8h-source.html#l00043">LLP_ERROR</a>, <a class="el" href="llp__packets_8h.html#545246ca514eb7b66943a0dfa12dcc50434da71d53a4041e0d9c648b82a46abb">LLP_NODE_HUNT</a>, <a class="el" href="llp_8h-source.html#l00039">LLP_OK</a>, and <a class="el" href="llp__data_8c-source.html#l00464">send_data()</a>.
<p>
Referenced by <a class="el" href="llp__data_8c-source.html#l00366">llp_hunt_for_nodes()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue Mar 20 00:15:39 2007 for Kurupira by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
